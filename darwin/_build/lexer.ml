# 3 "lexer.mll"
         
        open Parser        (* The type token is defined in parser.mli *)
	open Types
        exception Eof

	let dir_of_code s = match s with
		 "U" -> Up
		|"D" -> Down
		|"R" -> Right
		|"L" -> Left
		|"UL" -> Upleft
		|"DR" -> Downright
		| _ -> failwith "dir_of_code: unhandled case"

	let unite_of_code s = match s with
		 'A' -> ARMY
		|'T' -> TRANSPORT
		|'F' -> FIGHT
		|'B' -> BATTLESHIP
		|'P' -> PATROL
		| _ -> failwith "unite_of_code: unhandled case"
		
	let comp_of_code s = match s with
		  "<" -> Inf 
		| ">" -> Sup
		| "=" -> Eq  
		| "<=" -> InfEq  
		| ">=" -> SupEq  
        | _ -> failwith "comp_of_code: unhandled case"
        		
# 33 "lexer.ml"
let __ocaml_lex_tables = {
  Lexing.lex_base = 
   "\000\000\236\255\237\255\002\000\000\000\001\000\005\000\243\255\
    \006\000\003\000\244\255\003\000\011\000\245\255\041\000\247\255\
    \248\255\249\255\250\255\251\255\252\255\253\255\254\255\255\255\
    \014\000\008\000\009\000\001\000\242\255\021\000\241\255\240\255\
    \022\000\239\255\238\255";
  Lexing.lex_backtrk = 
   "\255\255\255\255\255\255\019\000\019\000\019\000\019\000\255\255\
    \012\000\012\000\255\255\011\000\011\000\255\255\009\000\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255";
  Lexing.lex_default = 
   "\001\000\000\000\000\000\255\255\255\255\255\255\255\255\000\000\
    \255\255\255\255\000\000\255\255\255\255\000\000\255\255\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \255\255\255\255\255\255\255\255\000\000\255\255\000\000\000\000\
    \255\255\000\000\000\000";
  Lexing.lex_trans = 
   "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\023\000\022\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \023\000\015\000\000\000\021\000\000\000\000\000\000\000\000\000\
    \019\000\018\000\000\000\000\000\020\000\000\000\000\000\000\000\
    \014\000\014\000\014\000\014\000\014\000\014\000\014\000\014\000\
    \014\000\014\000\017\000\000\000\012\000\010\000\011\000\016\000\
    \010\000\013\000\013\000\032\000\008\000\003\000\013\000\024\000\
    \010\000\029\000\027\000\000\000\007\000\005\000\006\000\007\000\
    \013\000\028\000\007\000\004\000\013\000\009\000\034\000\031\000\
    \007\000\014\000\014\000\014\000\014\000\014\000\014\000\014\000\
    \014\000\014\000\014\000\026\000\025\000\030\000\033\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \002\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000";
  Lexing.lex_check = 
   "\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\000\000\000\000\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\000\000\255\255\000\000\255\255\255\255\255\255\255\255\
    \000\000\000\000\255\255\255\255\000\000\255\255\255\255\255\255\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\255\255\000\000\000\000\000\000\000\000\
    \011\000\000\000\000\000\004\000\000\000\000\000\000\000\006\000\
    \012\000\025\000\026\000\255\255\000\000\000\000\000\000\009\000\
    \000\000\027\000\000\000\000\000\000\000\000\000\003\000\005\000\
    \008\000\014\000\014\000\014\000\014\000\014\000\014\000\014\000\
    \014\000\014\000\014\000\024\000\024\000\029\000\032\000\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255";
  Lexing.lex_base_code = 
   "";
  Lexing.lex_backtrk_code = 
   "";
  Lexing.lex_default_code = 
   "";
  Lexing.lex_trans_code = 
   "";
  Lexing.lex_check_code = 
   "";
  Lexing.lex_code = 
   "";
}

let rec token lexbuf =
    __ocaml_lex_token_rec lexbuf 0
and __ocaml_lex_token_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 35 "lexer.mll"
                             ( token lexbuf )
# 152 "lexer.ml"

  | 1 ->
# 36 "lexer.mll"
                             ( EOL  )
# 157 "lexer.ml"

  | 2 ->
# 37 "lexer.mll"
                      ( HASH )
# 162 "lexer.ml"

  | 3 ->
# 38 "lexer.mll"
                             ( VIRG )
# 167 "lexer.ml"

  | 4 ->
# 39 "lexer.mll"
                             ( LPAREN )
# 172 "lexer.ml"

  | 5 ->
# 40 "lexer.mll"
                             ( RPAREN )
# 177 "lexer.ml"

  | 6 ->
# 41 "lexer.mll"
                      ( COLON )
# 182 "lexer.ml"

  | 7 ->
# 42 "lexer.mll"
                      ( QMARK )
# 187 "lexer.ml"

  | 8 ->
# 43 "lexer.mll"
                      ( EMARK )
# 192 "lexer.ml"

  | 9 ->
let
# 44 "lexer.mll"
                   nb
# 198 "lexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 44 "lexer.mll"
                      ( INT(int_of_string nb) )
# 202 "lexer.ml"

  | 10 ->
let
# 45 "lexer.mll"
                              unite
# 208 "lexer.ml"
= Lexing.sub_lexeme_char lexbuf lexbuf.Lexing.lex_start_pos in
# 45 "lexer.mll"
                                    ( UNITE(unite_of_code unite))
# 212 "lexer.ml"

  | 11 ->
let
# 46 "lexer.mll"
                                comp
# 218 "lexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 46 "lexer.mll"
                                     ( COMP(comp_of_code comp))
# 222 "lexer.ml"

  | 12 ->
let
# 47 "lexer.mll"
                                    dir
# 228 "lexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 47 "lexer.mll"
                                        ( DIR(dir_of_code dir))
# 232 "lexer.ml"

  | 13 ->
# 50 "lexer.mll"
                      ( NBUAP )
# 237 "lexer.ml"

  | 14 ->
# 51 "lexer.mll"
                      ( NBVAP )
# 242 "lexer.ml"

  | 15 ->
# 54 "lexer.mll"
                ( MV )
# 247 "lexer.ml"

  | 16 ->
# 55 "lexer.mll"
                      ( SCP )
# 252 "lexer.ml"

  | 17 ->
# 56 "lexer.mll"
                      ( ET )
# 257 "lexer.ml"

  | 18 ->
# 58 "lexer.mll"
                             ( raise Eof )
# 262 "lexer.ml"

  | 19 ->
# 59 "lexer.mll"
                      ( token lexbuf )
# 267 "lexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf; 
      __ocaml_lex_token_rec lexbuf __ocaml_lex_state

;;

